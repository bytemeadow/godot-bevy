[gd_scene load_steps=2 format=3 uid="uid://bjsfwt816j4tp"]

[sub_resource type="GDScript" id="GDScript_1"]
script/source = "extends BevyApp

# Bulk Transform Optimization Methods
# Automatically detected by godot-bevy library for performance optimization

var _log_counter_3d = 0
var _log_counter_2d = 0

func update_transforms_bulk_3d(updates: Array):
	# Each update contains: { instance_id: i64, basis: Basis, origin: Vector3 }
	var processed = 0
	var failed = 0
	for update in updates:
		var instance_id = update.get(\"instance_id\", 0)
		var node = instance_from_id(instance_id) as Node3D
		if node and is_instance_valid(node):
			# Reconstruct Transform3D from components
			var basis = update.get(\"basis\", Basis.IDENTITY)
			var origin = update.get(\"origin\", Vector3.ZERO)
			node.transform = Transform3D(basis, origin)
			processed += 1
		else:
			failed += 1
	
	# Log processing stats every 60 calls (once per second at 60fps)
	_log_counter_3d += 1
	if _log_counter_3d % 60 == 1:
		print(\"GDScript: Processed \", processed, \" 3D transforms, failed: \", failed)

func update_transforms_bulk_2d(updates: Array):
	# Each update contains: { instance_id: i64, transform: Transform2D }
	var processed = 0
	var failed = 0
	for update in updates:
		var instance_id = update.get(\"instance_id\", 0)
		var node = instance_from_id(instance_id) as Node2D
		if node and is_instance_valid(node):
			node.transform = update.get(\"transform\", Transform2D.IDENTITY)
			processed += 1
		else:
			failed += 1
	
	# Log processing stats every 60 calls (once per second at 60fps)
	_log_counter_2d += 1
	if _log_counter_2d % 60 == 1:
		print(\"GDScript: Processed \", processed, \" 2D transforms, failed: \", failed)
"

[node name="BevyApp" type="BevyApp"]
script = SubResource("GDScript_1")
